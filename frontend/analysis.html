<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analysis Dashboard - DeepGuard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="animations.css">
</head>

<body class="analysis-page">
    <div class="mesh-background"></div>
    <div id="particles-js"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <a href="index.html" class="logo">
                    <img src="logo.svg" alt="DeepGuard Logo" class="logo-img">
                    <span class="logo-text">Deep<span class="gradient-text">Guard</span></span>
                </a>
                <ul class="nav-menu" style="margin-left: auto; padding-right: 40px;">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="analysis.html" class="active">Analysis</a></li>
                    <li><a href="history.html">History</a></li>
                </ul>
                <a href="index.html" class="btn-secondary-nav">‚Üê Back to Home</a>
            </div>
        </div>
    </nav>

    <main class="analysis-container">
        <div class="analysis-grid">
            <!-- Left Side: Upload & Preview -->
            <div class="upload-section">
                <div class="section-header-small">
                    <h2>Media Input</h2>
                    <p>Upload image for AI analysis</p>
                </div>

                <div class="upload-area animate-pulse-glow" id="uploadArea">
                    <div class="upload-icon animate-float">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                    </div>
                    <h3 class="upload-title">Drop Images Here</h3>
                    <p class="upload-description">Supports JPG, PNG, WEBP, MP4, AVI, MOV ¬∑ Images & Videos</p>
                    <p class="file-count-badge" id="fileCountBadge" style="display: none;"></p>
                    <input type="file" id="fileInput" accept="image/*,video/*" multiple hidden>
                    <button class="btn-primary" onclick="document.getElementById('fileInput').click()">Select
                        Files</button>
                    <!-- Scanner Line Effect -->
                    <div class="scanner-line"></div>
                </div>

                <!-- File Queue Preview -->
                <div class="file-queue-container" id="fileQueueContainer" style="display: none;">
                    <div class="queue-header">
                        <div class="queue-title-section">
                            <h3 class="queue-title">üìÇ Upload Queue</h3>
                            <span class="queue-count-badge" id="queueCount">0</span>
                        </div>
                        <div class="queue-actions">
                            <button class="btn-secondary-small" onclick="document.getElementById('fileInput').click()"
                                title="Add more files">
                                + Add More
                            </button>
                            <button class="btn-secondary-small" onclick="clearQueue()" title="Clear all files">
                                üóë Clear
                            </button>
                        </div>
                    </div>
                    <div class="file-queue" id="fileQueue"></div>
                    <div class="queue-footer">
                        <button class="btn-secondary-outline" onclick="clearQueue()" style="flex: 1;">
                            ‚Üê Back to Upload
                        </button>
                        <button class="btn-primary" onclick="processUploadQueue()" style="flex: 2;" id="startUploadBtn">
                            üöÄ Start Analysis
                        </button>
                    </div>
                </div>

                <div class="preview-area" id="previewArea" style="display: none;">
                    <img id="previewImage" src="" alt="Preview">
                    <img id="heatmapOverlay" src="" alt="Heatmap"
                        style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; opacity: 0; transition: opacity 0.5s ease;">

                    <div class="heatmap-toggle-container" id="heatmapToggle" style="display: none;">
                        <span class="toggle-label">Heatmap</span>
                        <label class="switch">
                            <input type="checkbox" id="heatmapSwitch">
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <button class="btn-close-preview" onclick="resetAnalysis()">√ó</button>
                </div>
            </div>

            <!-- Right Side: Results & Metrics -->
            <div class="results-section" id="resultsSection">
                <div class="empty-state">
                    <div class="empty-icon">‚ö°</div>
                    <h3>Ready to Analyze</h3>
                    <p>Upload media to start the DeepGuard detection pipeline</p>
                </div>

                <div class="analysis-results" style="display: none;">
                    <div class="verdict-card" id="verdictCard">
                        <span class="verdict-label">DETECTION RESULT</span>
                        <h1 class="verdict-title" id="verdictTitle">--</h1>
                        <div class="confidence-meter">
                            <div class="meter-bar">
                                <div class="meter-fill" id="confidenceBar"></div>
                            </div>
                            <span class="meter-value" id="confidenceValue">0%</span>
                        </div>
                    </div>

                </div>

                <div class="metrics-grid">
                    <!-- Chart Container -->
                    <div class="metric-card"
                        style="grid-column: span 2; display: flex; justify-content: center; align-items: center; padding: 20px;">
                        <canvas id="probabilityChart" style="max-height: 150px;"></canvas>
                    </div>

                    <div class="metric-card">
                        <span class="metric-label">Scan Time</span>
                        <span class="metric-value" id="scanTimeDisplay">--</span>
                    </div>
                    <div class="metric-card">
                        <span class="metric-label">Model Version</span>
                        <span class="metric-value">SigLIP v2</span>
                    </div>
                </div>

                <div class="analysis-details">
                    <h4>Forensic Analysis</h4>
                    <p id="analysisText">Waiting for analysis...</p>

                    <button class="btn-primary" id="downloadReportBtn"
                        style="margin-top: 20px; width: 100%; display: none;" onclick="generatePDFReport()">
                        üìÑ Download Forensic Report
                    </button>
                </div>
            </div>
        </div>
        </div>

        <!-- Statistics Overview -->
        <div class="container" style="max-width: 1200px; margin-top: 60px;" id="statisticsSection">
            <div class="section-header">
                <h2 class="section-title">Analysis <span class="gradient-text">Statistics</span></h2>
                <p class="section-subtitle">Overview of your detection history</p>
            </div>
            <div class="statistics-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-value" id="totalScans">0</div>
                    <div class="stat-label">Total Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö†Ô∏è</div>
                    <div class="stat-value" id="fakeCount">0</div>
                    <div class="stat-label">Fake Detected</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úì</div>
                    <div class="stat-value" id="realCount">0</div>
                    <div class="stat-label">Real Images</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-value" id="avgConfidence">0%</div>
                    <div class="stat-label">Avg Confidence</div>
                </div>
            </div>
        </div>

        <!-- Recent Analyses -->
        <div class="container" style="max-width: 1200px; margin-top: 40px; padding-bottom: 60px;" id="recentSection">
            <div class="section-header">
                <h2 class="section-title">Recent <span class="gradient-text">Analyses</span></h2>
                <a href="history.html" class="btn-secondary" style="font-size: 14px;">View All History ‚Üí</a>
            </div>
            <div class="recent-grid" id="recentGrid">
                <!-- Recent items will be populated here -->
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    <script src="motion.js"></script>
    <script src="script.js"></script>
</body>

</html>